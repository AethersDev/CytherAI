/**
 * ════════════════════════════════════════════════════════════════════════════════
 * CYTHERAI PHASE TRANSITION ENGINE - Authority Edition
 * ════════════════════════════════════════════════════════════════════════════════
 *
 * "Fast reveals nothing. Slow reveals truth."
 *
 * Deterministic. Hysteresis-based. φ-governed. No gimmicks.
 *
 * ════════════════════════════════════════════════════════════════════════════════
 */

/* ═══════════════════════════════════════════════════════════════════════════════
   φ-BASED DESIGN TOKEN LADDER
   All values derive from golden ratio (1.618) to create natural harmony.
   ═══════════════════════════════════════════════════════════════════════════════ */

:root {
    /* ─────────────────────────────────────────────────────────────────
       SPACING LADDER (φ-derived, base 8px)
       8 × φⁿ progression
       ───────────────────────────────────────────────────────────────── */
    --space-0: 0;
    --space-1: 5px;      /* 8 / φ */
    --space-2: 8px;      /* base */
    --space-3: 13px;     /* 8 × φ⁰·⁵ */
    --space-4: 21px;     /* 8 × φ¹·⁵ */
    --space-5: 34px;     /* 8 × φ² */
    --space-6: 55px;     /* 8 × φ²·⁵ */
    --space-7: 89px;     /* 8 × φ³ */
    --space-8: 144px;    /* 8 × φ³·⁵ */

    /* ─────────────────────────────────────────────────────────────────
       TYPOGRAPHY LADDER (φ-derived, base 16px)
       ───────────────────────────────────────────────────────────────── */
    --type-xs: 10px;     /* 16 / φ¹·⁵ */
    --type-sm: 13px;     /* 16 / φ */
    --type-base: 16px;   /* base */
    --type-lg: 21px;     /* 16 × φ⁰·⁵ */
    --type-xl: 26px;     /* 16 × φ */
    --type-2xl: 33px;    /* 16 × φ¹·⁵ */
    --type-3xl: 42px;    /* 16 × φ² */
    --type-4xl: 55px;    /* 16 × φ²·⁵ */
    --type-5xl: 68px;    /* 16 × φ³ */

    /* Line height = φ */
    --leading-tight: 1.2;
    --leading-normal: 1.618;
    --leading-relaxed: 1.85;

    /* ─────────────────────────────────────────────────────────────────
       TIMING LADDER (φ-derived, base 100ms)
       ───────────────────────────────────────────────────────────────── */
    --time-instant: 50ms;
    --time-fast: 100ms;
    --time-normal: 160ms;    /* 100 × φ⁰·⁵ */
    --time-slow: 260ms;      /* 100 × φ */
    --time-slower: 420ms;    /* 100 × φ¹·⁵ */
    --time-slowest: 680ms;   /* 100 × φ² */

    /* ─────────────────────────────────────────────────────────────────
       SCROLL LANDMARKS (φ emergence points)
       ───────────────────────────────────────────────────────────────── */
    --scroll-emergence: 0.382;   /* 1 - φ⁻¹ */
    --scroll-balance: 0.618;     /* φ⁻¹ (THE critical point) */
    --scroll-completion: 0.854;  /* φ⁻¹ + φ⁻² */

    /* ─────────────────────────────────────────────────────────────────
       OPTICAL CENTERLINE
       Single axis of truth for all primary elements.
       ───────────────────────────────────────────────────────────────── */
    --optical-offset: 0px;       /* Compensates for asymmetric weight */
    --content-max-width: 890px;

    /* ─────────────────────────────────────────────────────────────────
       THERMAL STATES (internal, 3 visible behaviors)
       Hot → Warm → Cold
       ───────────────────────────────────────────────────────────────── */
    --thermal-hot: rgba(255, 248, 232, 0.7);
    --thermal-warm: rgba(212, 175, 55, 1);
    --thermal-cold: rgba(244, 228, 188, 1);

    /* Current phase properties (set by JS) */
    --phase-blur: 0px;
    --phase-opacity: 1;
    --phase-sharpness: 0;
}

/* ═══════════════════════════════════════════════════════════════════════════════
   PHASE STATE: HOT (Fast Scroll)
   Content becomes less legible, more suggestive. Reveals nothing.
   ═══════════════════════════════════════════════════════════════════════════════ */

body[data-thermal="hot"] {
    --phase-blur: 2px;
    --phase-opacity: 0.75;
}

body[data-thermal="hot"] .chapter-stamp,
body[data-thermal="hot"] .sovereign-headline,
body[data-thermal="hot"] .chapter-claim,
body[data-thermal="hot"] .gate-stamp {
    filter: blur(var(--phase-blur));
    opacity: var(--phase-opacity);
    transition:
        filter var(--time-fast) ease-out,
        opacity var(--time-fast) ease-out;
}

/* Hot state: suggestive motion residue */
body[data-thermal="hot"] .plate-surface {
    border-color: rgba(212, 175, 55, 0.1);
    transition: border-color var(--time-fast) ease-out;
}

/* ═══════════════════════════════════════════════════════════════════════════════
   PHASE STATE: WARM (Normal Scroll)
   Content is readable, stable. Default state.
   ═══════════════════════════════════════════════════════════════════════════════ */

body[data-thermal="warm"] {
    --phase-blur: 0px;
    --phase-opacity: 1;
}

body[data-thermal="warm"] .chapter-stamp,
body[data-thermal="warm"] .sovereign-headline,
body[data-thermal="warm"] .chapter-claim,
body[data-thermal="warm"] .gate-stamp {
    filter: blur(0);
    opacity: 1;
    transition:
        filter var(--time-normal) ease-out,
        opacity var(--time-normal) ease-out;
}

body[data-thermal="warm"] .plate-surface {
    border-color: rgba(212, 175, 55, 0.2);
    transition: border-color var(--time-normal) ease-out;
}

/* ═══════════════════════════════════════════════════════════════════════════════
   PHASE STATE: COLD (Slow + Pause)
   Content crystallizes—sharp, precise, sealed. Reveals truth.
   ═══════════════════════════════════════════════════════════════════════════════ */

body[data-thermal="cold"] {
    --phase-blur: 0px;
    --phase-opacity: 1;
    --phase-sharpness: 1;
}

body[data-thermal="cold"] .chapter-stamp,
body[data-thermal="cold"] .sovereign-headline,
body[data-thermal="cold"] .gate-stamp {
    filter: blur(0);
    opacity: 1;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
    text-shadow:
        0 0 var(--space-3) rgba(212, 175, 55, 0.3),
        0 0 var(--space-5) rgba(212, 175, 55, 0.15);
    transition:
        filter var(--time-slow) ease-out,
        text-shadow var(--time-slower) ease-out;
}

body[data-thermal="cold"] .chapter-claim {
    opacity: 1;
    color: var(--gold-white, #f5f5f0);
    transition: all var(--time-slow) ease-out;
}

/* Cold state: crystalline border precision */
body[data-thermal="cold"] .plate-surface {
    border-color: rgba(212, 175, 55, 0.4);
    box-shadow:
        0 0 0 1px rgba(212, 175, 55, 0.15),
        0 0 var(--space-5) rgba(212, 175, 55, 0.08);
    transition:
        border-color var(--time-slower) ease-out,
        box-shadow var(--time-slower) ease-out;
}

/* ═══════════════════════════════════════════════════════════════════════════════
   NUCLEATION SITES
   Key elements crystallize FIRST. Creates hierarchy without UI.
   ═══════════════════════════════════════════════════════════════════════════════ */

[data-nucleation="primary"] {
    transition-delay: 0ms !important;
}

[data-nucleation="secondary"] {
    transition-delay: var(--time-fast) !important;
}

[data-nucleation="tertiary"] {
    transition-delay: var(--time-normal) !important;
}

/* Cold state nucleation glow - subtle, not UI */
body[data-thermal="cold"] [data-nucleation="primary"] {
    position: relative;
}

body[data-thermal="cold"] [data-nucleation="primary"]::after {
    content: '';
    position: absolute;
    inset: calc(var(--space-3) * -1);
    background: radial-gradient(
        ellipse at center,
        rgba(212, 175, 55, 0.06) 0%,
        transparent 70%
    );
    pointer-events: none;
    z-index: -1;
    opacity: 0;
    animation: nucleation-emerge var(--time-slowest) ease-out forwards;
}

@keyframes nucleation-emerge {
    from { opacity: 0; transform: scale(0.9); }
    to { opacity: 1; transform: scale(1); }
}

/* ═══════════════════════════════════════════════════════════════════════════════
   CRYSTALLINE FACETS (Capped at 2-3)
   Progressive micro-reveals on sustained pause.
   ═══════════════════════════════════════════════════════════════════════════════ */

[data-facet] {
    opacity: 0;
    max-height: 0;
    overflow: hidden;
    transition:
        opacity var(--time-slow) ease-out,
        max-height var(--time-slower) ease-out;
}

[data-facet="1"] {
    opacity: 1;
    max-height: none;
}

/* Facet 2: First crystalline reveal */
body[data-crystal-depth="2"] [data-facet="2"],
body[data-crystal-depth="3"] [data-facet="2"] {
    opacity: 0.9;
    max-height: 200px;
}

/* Facet 3: Maximum depth (rare) */
body[data-crystal-depth="3"] [data-facet="3"] {
    opacity: 0.85;
    max-height: 200px;
}

/* Crystalline facet styling */
[data-facet="2"],
[data-facet="3"] {
    font-size: var(--type-sm);
    color: var(--gold-muted, #9c9b96);
    padding-top: var(--space-3);
    margin-top: var(--space-3);
    border-top: 1px solid rgba(212, 175, 55, 0.1);
}

/* ═══════════════════════════════════════════════════════════════════════════════
   SEED CRYSTAL (3 Appearances - Diegetic Only)
   No dashboard. Appears as environmental marker.
   ═══════════════════════════════════════════════════════════════════════════════ */

.seed-crystal {
    position: fixed;
    width: var(--space-6);
    height: var(--space-6);
    pointer-events: none;
    z-index: 50;
    opacity: 0;
    transition: opacity var(--time-slower) ease-out;
}

.seed-crystal[data-visible="true"] {
    opacity: 1;
}

.seed-crystal svg {
    width: 100%;
    height: 100%;
    color: var(--gold-dim, #8a6e1f);
}

/* Positions at φ landmarks */
.seed-crystal[data-position="emergence"] {
    top: 38.2%;
    right: var(--space-4);
}

.seed-crystal[data-position="balance"] {
    top: 61.8%;
    right: var(--space-4);
}

.seed-crystal[data-position="completion"] {
    top: 85.4%;
    right: var(--space-4);
}

/* Cold state: crystal becomes prominent */
body[data-thermal="cold"] .seed-crystal[data-visible="true"] svg {
    color: var(--gold-core, #d4af37);
    filter: drop-shadow(0 0 var(--space-2) rgba(212, 175, 55, 0.4));
}

/* ═══════════════════════════════════════════════════════════════════════════════
   TRIPLE POINT AT 0.618
   All three behaviors briefly coexist, then resolve.
   ═══════════════════════════════════════════════════════════════════════════════ */

body[data-triple-point="true"] .dossier-plate {
    /* Hot residue in background */
    background: linear-gradient(
        135deg,
        rgba(255, 248, 232, 0.02) 0%,
        transparent 30%,
        transparent 70%,
        rgba(244, 228, 188, 0.02) 100%
    );
}

body[data-triple-point="true"] .chapter-stamp {
    /* Momentary shimmer across all temperatures */
    animation: triple-shimmer var(--time-slowest) ease-out;
}

@keyframes triple-shimmer {
    0% {
        text-shadow:
            0 0 var(--space-4) rgba(255, 248, 232, 0.4),
            0 0 var(--space-2) rgba(212, 175, 55, 0.3);
    }
    50% {
        text-shadow:
            0 0 var(--space-3) rgba(212, 175, 55, 0.5),
            0 0 var(--space-5) rgba(244, 228, 188, 0.2);
    }
    100% {
        text-shadow:
            0 0 var(--space-3) rgba(212, 175, 55, 0.3),
            0 0 var(--space-5) rgba(212, 175, 55, 0.15);
    }
}

/* ═══════════════════════════════════════════════════════════════════════════════
   DIEGETIC THERMAL INDICATORS (No Dashboard)
   Environmental cues only—reticle, vignette, calibration marks.
   ═══════════════════════════════════════════════════════════════════════════════ */

/* Vignette sharpening in cold state */
.thermal-vignette {
    position: fixed;
    inset: 0;
    pointer-events: none;
    z-index: 9990;
    opacity: 0;
    background: radial-gradient(
        ellipse at 50% 50%,
        transparent 50%,
        rgba(0, 0, 0, 0.15) 100%
    );
    transition: opacity var(--time-slower) ease-out;
}

body[data-thermal="cold"] .thermal-vignette {
    opacity: 1;
}

/* Edge reticle - tightens in cold state */
.thermal-reticle {
    position: fixed;
    inset: var(--space-4);
    border: 1px solid transparent;
    pointer-events: none;
    z-index: 9989;
    transition:
        border-color var(--time-slower) ease-out,
        inset var(--time-slower) ease-out;
}

body[data-thermal="cold"] .thermal-reticle {
    border-color: rgba(212, 175, 55, 0.08);
    inset: var(--space-3);
}

/* Calibration marks in corners (cold state only) */
.calibration-mark {
    position: fixed;
    width: var(--space-4);
    height: 1px;
    background: rgba(212, 175, 55, 0.15);
    opacity: 0;
    transition: opacity var(--time-slow) ease-out;
    pointer-events: none;
    z-index: 9988;
}

body[data-thermal="cold"] .calibration-mark {
    opacity: 1;
}

.calibration-mark.top-left { top: var(--space-4); left: var(--space-4); }
.calibration-mark.top-right { top: var(--space-4); right: var(--space-4); }
.calibration-mark.bottom-left { bottom: var(--space-4); left: var(--space-4); }
.calibration-mark.bottom-right { bottom: var(--space-4); right: var(--space-4); }

.calibration-mark.vertical {
    width: 1px;
    height: var(--space-4);
}

/* ═══════════════════════════════════════════════════════════════════════════════
   BROWNIAN RESIDUE (Simplified)
   Hot: visible motion. Cold: stillness. No particle system overhead.
   ═══════════════════════════════════════════════════════════════════════════════ */

.brownian-field {
    position: fixed;
    inset: 0;
    pointer-events: none;
    z-index: 1;
    opacity: 0;
    background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 100 100' xmlns='http://www.w3.org/2000/svg'%3E%3Ccircle cx='20' cy='30' r='0.5' fill='%23d4af37' opacity='0.3'/%3E%3Ccircle cx='70' cy='60' r='0.3' fill='%23d4af37' opacity='0.2'/%3E%3Ccircle cx='40' cy='80' r='0.4' fill='%23d4af37' opacity='0.25'/%3E%3Ccircle cx='85' cy='20' r='0.35' fill='%23d4af37' opacity='0.2'/%3E%3C/svg%3E");
    background-size: 200px 200px;
    transition: opacity var(--time-normal) ease-out;
}

body[data-thermal="hot"] .brownian-field {
    opacity: 0.6;
    animation: brownian-drift 3s linear infinite;
}

body[data-thermal="warm"] .brownian-field {
    opacity: 0.2;
    animation: brownian-drift 8s linear infinite;
}

body[data-thermal="cold"] .brownian-field {
    opacity: 0;
    animation: none;
}

@keyframes brownian-drift {
    0% { background-position: 0 0; }
    100% { background-position: 200px 200px; }
}

/* ═══════════════════════════════════════════════════════════════════════════════
   OPTICAL CENTERLINE GOVERNANCE
   All primary narrative objects share ONE axis.
   ═══════════════════════════════════════════════════════════════════════════════ */

/* Primary elements: centered on optical axis */
.hero-content,
.briefing-dossier,
.dossier-plate .plate-surface,
.gate-hard {
    max-width: var(--content-max-width);
    margin-left: auto;
    margin-right: auto;
    transform: translateX(var(--optical-offset));
}

/* Peripheral elements: low mass, no axis pull */
.thermal-vignette,
.thermal-reticle,
.calibration-mark,
.seed-crystal,
.brownian-field {
    /* These exist outside optical axis */
}

/* ═══════════════════════════════════════════════════════════════════════════════
   RESPONSIVE + REDUCED MOTION
   ═══════════════════════════════════════════════════════════════════════════════ */

@media (max-width: 768px) {
    .seed-crystal {
        display: none;
    }

    .thermal-reticle {
        display: none;
    }

    .calibration-mark {
        display: none;
    }
}

@media (prefers-reduced-motion: reduce) {
    body[data-thermal] .chapter-stamp,
    body[data-thermal] .sovereign-headline,
    body[data-thermal] .chapter-claim {
        filter: none !important;
        animation: none !important;
        transition: opacity var(--time-fast) ease-out !important;
    }

    .brownian-field {
        animation: none !important;
        opacity: 0.1 !important;
    }

    [data-nucleation]::after {
        animation: none !important;
    }
}

/* ═══════════════════════════════════════════════════════════════════════════════
   HYSTERESIS INDICATOR (Console only, not visual)
   Visual indication that state is "locked" until threshold crossed.
   ═══════════════════════════════════════════════════════════════════════════════ */

/* No visual hysteresis UI - handled in JS, manifests as transition smoothness */
